\subsection{Описание REST API веб-сервиса}
В этом разделе содержится перечисление всех вызовов HTTP REST API, которые поддерживает веб-сервис, а так же описание запросов и ответов.

\subsubsection{Запросы}
Передать для сохранения параметры подключения к приложению под управлением ''Kubernetes'' можно с помощью запроса, описание которого приведено в табл.~\ref{create-kubernetes}.

Передать для сохранения параметры подключения к приложению под управлением ''OpenNebula'' можно с помощью запроса, описание которого приведено в табл.~\ref{create-opennebula}.

Обновить параметры ранее созданного подключения к приложению под управлением ''OpenNebula'' можно с помощью запроса, описание которого приведено в табл.~\ref{update-opennebula}.

Обновить параметры ранее созданного подключения к приложению под управлением ''Kubernetes'' можно с помощью запроса, описание которого приведено в табл.~\ref{update-kubernetes}.

Запросить список приложений, параметры подключения к которым сохранены в СУБД, можно с помощью запроса, описание которого приведено в табл.~\ref{get-apps}.

Удалить ранее сохранённые параметры подключения к приложению вне зависимости от платформы, под управлением которой оно находится, можно с помощью запроса, описание которого приведено в табл.~\ref{delete-app}.

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Метод & POST \\
        \hline
        Адрес & /api/v1/kubernetes/\{namespace\}/\{deployment\}/ \\
        \hline
        Параметры запроса & { \begin{tabularx}{\linewidth}{l c X}
        \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
        \hline
        namespace & String & Namespace, к которому относится приложение. \\
        \hline
        deployment & String & Deployment, к которому относится приложение. \\
        \end{tabularx} } \\
        \hline
        Тело запроса & Конфигурация подключения к ''Kubernetes'' в формате YAML.
    \end{tabularx}
    \caption{Описание запроса сохранения параметров подключения к ''Kubernetes''-приложению}
    \label{create-kubernetes}
\end{table}

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Метод & PUT \\
        \hline
        Адрес & /api/v1/kubernetes/\{namespace\}/\{deployment\}/\{id\}/ \\
        \hline
        Параметры запроса & { \begin{tabularx}{\linewidth}{l c X}
        \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
        \hline
        namespace & String & Namespace, к которому относится приложение. \\
        \hline
        deployment & String & Deployment, к которому относится приложение. \\
        \hline
        id & int64 & Идентификатор существующей конфигурации, которая должна быть обновлена. \\
        \end{tabularx} } \\
        \hline
        Тело запроса & Конфигурация подключения к ''Kubernetes'' в формате YAML.
    \end{tabularx}
    \caption{Описание запроса обновления сохранённых параметров подключения к ''Kubernetes''-приложению}
    \label{update-kubernetes}
\end{table}

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Метод & GET \\
        \hline
        Адрес & /api/v1/app \\
    \end{tabularx}
    \caption{Описание запроса списка сохранённых приложений}
    \label{get-apps}
\end{table}

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Метод & DELETE \\
        \hline
        Адрес & /api/v1/app/\{id\} \\
        \hline
        Параметры запроса & { \begin{tabularx}{\linewidth}{l c X}
        \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
        \hline
        id & int64 & Идентификатор удаляемого приложения. \\
        \end{tabularx} } \\
    \end{tabularx}
    \caption{Описание запроса удаления сохранённого приложения}
    \label{delete-app}
\end{table}

Запросить список ВМ или контейнеров относящихся к приложению, параметры подключения к которому ранее были сохранены, вне зависимости от платформы, под управлением которой оно находится, а так же статистическую информацию об использованных ими ресурсах, можно с помощью запроса, описание которого приведено в табл.~\ref{get-app}.

Осуществить масштабирование приложения, параметры подключения к которому ранее были сохранены, вне зависимости от платформы, под управлением которой оно находится, можно с помощью запроса, описание которого приведено в табл.~\ref{scale-app}.
\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Метод & GET \\
        \hline
        Адрес & /api/v1/app/\{id\} \\
        \hline
        Параметры запроса & { \begin{tabularx}{\linewidth}{l c X}
        \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
        \hline
        id & int64 & Идентификатор приложения, состояние которого должно быть возвращено. \\
        \end{tabularx} } \\
    \end{tabularx}
    \caption{Описание запроса состояния сохранённого приложения}
    \label{get-app}
\end{table}

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Метод & PATCH \\
        \hline
        Адрес & /api/v1/app/\{id\} \\
        \hline
        Тело запроса & Тело запроса передаётся в формате JSON. { \begin{tabularx}{\linewidth}{l c X}
        \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
        \hline
        incrementBy & int64 & Количество ВМ или контейнеров, на которое должно быть увеличены доступные приложению ресурсы. В случае, если число отрицательное, такое количество ВМ или контейнеров приложения будет отключено. \\
        \end{tabularx} } \\
    \end{tabularx}
    \caption{Описание запроса масштабирования приложения}
    \label{scale-app}
\end{table}

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Метод & POST \\
        \hline
        Адрес & /api/v1/opennebula/ \\
        \hline
        Тело запроса & Тело запроса передаётся в формате JSON. { \begin{tabularx}{\linewidth}{l c X}
        \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
        \hline
        address & String & URL, по которому находится XML RPC API OpenNebula, к которой осуществляется подключение. \\
        \hline
        login & String & Логин пользователя, с которым осуществляется подключение. \\
        \hline
        password & String & Пароль пользователя, с которым осуществляется подключение. \\
        \hline
        password & String & Пароль пользователя, с которым осуществляется подключение. \\
        \hline
        role & int64 & Идентификатор роли, к которой относятся ВМ управляемого приложения. \\
        \hline
        template & int64 & Идентификатор шаблона, по которому создаются новые ВМ управляемого приложения. \\
        \hline
        vmgroup & int64 & Идентификатор группы ВМ, в котороую входят ВМ управляемого приложения. \\
        \end{tabularx} } \\
    \end{tabularx}
    \caption{Описание запроса сохранения параметров подключения к ''OpenNebula''-приложению}
    \label{create-opennebula}
\end{table}

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Метод & PUT  \\
        \hline
        Адрес & /api/v1/opennebula/\{id\}/ \\
        \hline
        Тело запроса & Тело запроса передаётся в формате JSON. { \begin{tabularx}{\linewidth}{l c X}
        \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
        \hline
        address & String & URL, по которому находится XML RPC API OpenNebula, к которой осуществляется подключение. \\
        \hline
        login & String & Логин пользователя, с которым осуществляется подключение. \\
        \hline
        password & String & Пароль пользователя, с которым осуществляется подключение. \\
        \hline
        password & String & Пароль пользователя, с которым осуществляется подключение. \\
        \hline
        role & int64 & Идентификатор роли, к которой относятся ВМ управляемого приложения. \\
        \hline
        template & int64 & Идентификатор шаблона, по которому создаются новые ВМ управляемого приложения. \\
        \hline
        vmgroup & int64 & Идентификатор группы ВМ, в котороую входят ВМ управляемого приложения. \\
        \end{tabularx} } \\
        \hline
        Параметры запроса & { \begin{tabularx}{\linewidth}{l c X}
        \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
        \hline
        id & int64 & Идентификатор конфигурации OpenNebula приложения, которая должна быть обновлена. \\
        \end{tabularx} } \\
    \end{tabularx}
    \caption{Описание запроса обновления параметров подключения к ''OpenNebula''-приложению}
    \label{update-opennebula}
\end{table}

\FloatBarrier

\subsubsection{Ответы}
Ответ на любой запрос может содержать либо описание ошибки в формате, который является общим для всех запросов, либо содержать тело ответа в формате, зависящем от запроса, либо содержать только HTTP-код ответа без тела сообщения.

Описание общего формата ошибки приведено в табл.~\ref{general-error}.

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Код ответа & {
            \begin{tabularx}{\linewidth}{l | X}
                \textbf{Код} & \textbf{Причина} \\
                \hline
                500 & Внутренняя ошибка сервера, вызванная непредусмотренным набором параметров запроса. \\
                \hline
                400 & В полученном запросе обнаружена ошибка, запрос нужно сформировать заново. \\
                \hline
                404 & Полученный запрос был направлен на неизвестный серверу путь, запрос нужно сформировать заново. \\
            \end{tabularx}
        } \\
        \hline
        Тело ответа & {
            Тело ответа передаётся в формате JSON.
            \begin{tabularx}{\linewidth}{l l X}
                \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
                \hline
                timestamp & String & Время возникновения ошибки. Формат записи времени соответствует стандарту ISO 8601. \\
                \hline
                status & int64 & HTTP-код ответа. \\
                \hline
                error & String & Текстовое описание HTTP-кода ответа на английском языке. \\
                \hline
                message & String & Текстовое описание возникшей ошибки на английском языке. \\
                \hline
                path & String & Путь на сервере, на который был получен запрос. Вычисляется относительно корневого пути, без адреса самого сервера. \\
            \end{tabularx}
        } \\
    \end{tabularx}
    \caption{Описание общего для всех запросов формата описания ошибки}
    \label{general-error}
\end{table}

Ответ на запрос сохранения параметров вне зависимости от платформы, параметры подключения к которой были сохранены, а так же ответ на запрос удаления приложения описан в табл.~\ref{create-delete-response}.

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{l | X}
        Код ответа & 200 \\
        \hline
        Тело ответа & {
            Тело ответа передаётся в формате JSON.
            \begin{tabularx}{\linewidth}{l l X}
                \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
                \hline
                appId & int64 & Идентификатор приложения, которое только что было создано или удалено. \\
            \end{tabularx}
        } \\
    \end{tabularx}
    \caption{Описание ответа на запросы сохранения и удаления параметров подключения в случае успеха проведения операции}
    \label{create-delete-response}
\end{table}

Ответ на запрос списка сохранённых приложений, то есть списка известных параметров подключения к приложениям, описан в табл.~\ref{get-apps-response}.

Ответы на запрос состояния приложения и на запрос масштабирования приложения не зависят от платформы, под управлением которой находится само приложение. Формат ответа описан в табл.~\ref{get-app-response}.

Ответ на запрос обновления конфигурации так же не зависит от платформы облачных вычислений, к которой относится конфигурация.
Формат ответа описан в табл.~\ref{update-response}.

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{p{0.2\textwidth} | X}
        Код ответа & 200 \\
    \end{tabularx}
    \caption{Описание ответа на запрос обновления конфигурации}
    \label{update-response}
\end{table}

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{p{0.2\textwidth} | X}
        Код ответа & 200 \\
        \hline
        Тело ответа & {
            Тело ответа передаётся в формате JSON.
            \begin{tabularx}{\linewidth}{l X}
                \textbf{Имя} & \textbf{Тип} \\
                \hline
                openNebulaApps & OpenNebulaApp[] \\
                \hline
                kubernetesApps & KubernetesApp[] \\
            \end{tabularx}
        } \\
        \hline
        Тип данных OpenNebulaApp & {
        Объекты этого типа используются для описания сохранённой конфигурации параметров подключения к приложению под управлением ''OpenNebula''.
        \begin{tabularx}{\linewidth}{l l X}
                \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
                \hline
                appId & int64 & Идентификатор этого приложения. \\
                \hline
                address & String & URL-адрес, по которому расположен XML RPC API системы ''OpenNebula''. \\
                \hline
                role & int64 & Идентификатор роли, к которой относятся ВМ этого приложения. \\
                \hline
                template & int64 & Идентификатор шаблона, по которому создаются ВМ этого приложения. \\
                \hline
                template & int64 & Идентификатор группы ВМ, в которую входят ВМ этого приложения. \\
            \end{tabularx}
        } \\
        \hline
        Тип данных KubernetesApp & {
        Объекты этого типа используются для описания сохранённой конфигурации параметров подключения к приложению под управлением ''Kubernetes''.
        \begin{tabularx}{\linewidth}{l l X}
                \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
                \hline
                appId & int64 & Идентификатор этого приложения. \\
                \hline
                namespace & String & Namespace, в который входит это приложение. \\
                \hline
                deployment & String & Deployment, в который входит это приложение. \\
            \end{tabularx}
        } \\
    \end{tabularx}
    \caption{Описание ответа на запрос списка сохранённых приложений}
    \label{get-apps-response}
\end{table}

\begin{table}[hbtp]
    \begin{tabularx}{\textwidth}{p{0.2\textwidth} | X}
        Код ответа & 200 \\
        \hline
        Тело ответа & Тело ответа передаётся в формате JSON.
            Сам ответ является массивом объектов типа Instance. \\
        \hline
        Тип данных Instance & {
        Объекты этого типа используются для описания состояния одного контейнера или ВМ приложения.
        \begin{tabularx}{\linewidth}{l l X}
                \textbf{Имя} & \textbf{Тип} & \textbf{Описание} \\
                \hline
                name & String & Имя контейнера или ВМ, по которому его можно идентифицировать внутри платформы облачных вычислений. \\
                \hline
                cpuload & float64 & Загрузка ЦПУ (CPU). 
                Это значение показывает какое количество вычислительных ядер использовалось в среднем последнюю минуту. 
                Например, 2.3 означает, что 2 вычислительных ядра исполняло команды только этой задачи, а третье 70\% времени исполняло команды других задач. \\
                \hline
                ramload & float64 & Загрузка оперативной памяти (RAM). 
                Это значение показывает какое количество байт памяти было занято данными этой задачи в последнюю минуту. 
                Например, 1024 означает, что 1 КиБ памяти был использован этой задачей. \\
            \end{tabularx}
        } \\
    \end{tabularx}
    \caption{Описание ответа на запросы состояния и масштабирования приложения}
    \label{get-app-response}
\end{table}

\FloatBarrier